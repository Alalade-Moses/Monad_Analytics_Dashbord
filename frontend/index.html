<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monad Analytics - Blockchain Analytics Dashboard</title>
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" href="/assets/monad-favicon.ico" type="image/x-icon">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo">
                <div class="logo-icon">M</div>
                Monad Analytics
            </a>
            <button class="mobile-menu-toggle">â˜°</button>
            <ul class="nav-links">
                <li><a href="/" class="active">Home</a></li>
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/transactions">Transactions</a></li>
                <li><a href="/validators">Validators</a></li>
                <li><a href="/dapps">dApps</a></li>
                <li><a href="/network">Network</a></li>
            </ul>
        </div>
    </nav>

    <main class="main-content">
        <div class="container">
            <section class="hero fade-in-up">
                <h1>Monad Blockchain Analytics</h1>
                <p>Real-time insights and comprehensive analytics for the Monad ecosystem. Monitor network performance, track transactions, and explore the growing dApp landscape.</p>
                <div class="mt-3">
                    <a href="/dashboard" class="btn btn-primary">View Dashboard</a>
                    <a href="/network" class="btn btn-secondary">Network Status</a>
                </div>
            </section>

            

            <section class="metrics-grid fade-in-up" id="overview-metrics">
                <div class="metric-card">
                    <div class="metric-value" id="network-tps">--</div>
                    <div class="metric-label">Transactions Per Second</div>
                    <div class="metric-change positive">+15.3% from yesterday</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="active-validators">--</div>
                    <div class="metric-label">Active Validators</div>
                    <div class="metric-change positive">+2 new validators</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="total-tvl">--</div>
                    <div class="metric-label">Total Value Locked</div>
                    <div class="metric-change positive">+8.7% this week</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="block-height">--</div>
                    <div class="metric-label">Current Block Height</div>
                    <div class="metric-change">Live</div>
                </div>
            </section>

            <div class="grid grid-2 fade-in-up">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Network Overview</h3>
                        <span class="status success">
                            <div class="status-dot"></div>
                            Healthy
                        </span>
                    </div>
                    <div class="card-content">
                        <div class="mb-2">
                            <strong>Average Block Time:</strong> 
                            <span id="avg-block-time">--</span>s
                        </div>
                        <div class="mb-2">
                            <strong>Network Hashrate:</strong> 
                            <span id="network-hashrate">--</span>
                        </div>
                        <div class="mb-2">
                            <strong>Gas Price:</strong> 
                            <span id="gas-price">--</span> gwei
                        </div>
                        <div class="mb-2">
                            <strong>Total Supply:</strong> 
                            <span id="total-supply">--</span> MON
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Recent Activity</h3>
                        <a href="/transactions" class="btn btn-secondary">View All</a>
                    </div>
                    <div class="card-content">
                        <div id="recent-transactions">
                            <div class="loading">
                                <div class="spinner"></div>
                                Loading recent transactions...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-2 fade-in-up">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Top Validators</h3>
                        <a href="/validators" class="btn btn-secondary">View All</a>
                    </div>
                    <div class="card-content">
                        <div id="top-validators">
                            <div class="loading">
                                <div class="spinner"></div>
                                Loading validators...
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Top dApps</h3>
                        <a href="/dapps" class="btn btn-secondary">View All</a>
                    </div>
                    <div class="card-content">
                        <div id="top-dapps">
                            <div class="loading">
                                <div class="spinner"></div>
                                Loading dApps...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <section class="card fade-in-up">
                <div class="card-header">
                    <h3 class="card-title">About Monad Analytics</h3>
                </div>
                <div class="card-content">
                    <p>Monad Analytics provides comprehensive real-time and historical data about the Monad blockchain ecosystem. Our platform offers detailed insights into network performance, validator statistics, transaction flows, and dApp analytics to help users, developers, and stakeholders make informed decisions.</p>
                    <div class="mt-3">
                        <h4 class="mb-2">Key Features:</h4>
                        <ul style="color: var(--text-secondary); margin-left: 1.5rem;">
                            <li>Real-time network monitoring and performance metrics</li>
                            <li>Comprehensive validator performance tracking</li>
                            <li>Transaction analytics and search capabilities</li>
                            <li>dApp ecosystem insights and TVL tracking</li>
                            <li>Historical data analysis and trending</li>
                            <li>API access for developers and integrations</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script src="/js/api.js"></script>
    <script>
        // Initialize homepage
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const data = await api.getDashboardData();
                
                if (data.network) {
                    document.getElementById('network-tps').textContent = data.network.tps?.toLocaleString() || '--';
                    document.getElementById('active-validators').textContent = data.network.activeValidators?.toLocaleString() || '--';
                    document.getElementById('block-height').textContent = data.network.blockHeight?.toLocaleString() || '--';
                    document.getElementById('avg-block-time').textContent = data.network.avgBlockTime || '--';
                    document.getElementById('network-hashrate').textContent = data.network.networkHashrate || '--';
                    document.getElementById('gas-price').textContent = data.network.gasPrice || '--';
                    document.getElementById('total-supply').textContent = parseInt(data.network.totalSupply || 0).toLocaleString();
                }

                if (data.metrics) {
                    document.getElementById('total-tvl').textContent = '$' + (data.metrics.totalTvl / 1000000).toFixed(1) + 'M';
                }

                // Recent transactions
                const transactionsContainer = document.getElementById('recent-transactions');
                if (data.recentTransactions && data.recentTransactions.length > 0) {
                    transactionsContainer.innerHTML = data.recentTransactions.slice(0, 5).map(tx => `
                        <div style="padding: 0.75rem 0; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 500;">${tx.hash.substring(0, 10)}...${tx.hash.slice(-8)}</div>
                                <div style="font-size: 0.75rem; color: var(--text-muted);">${tx.value} MON</div>
                            </div>
                            <span class="status ${tx.status === 'success' ? 'success' : 'error'}">
                                <div class="status-dot"></div>
                                ${tx.status}
                            </span>
                        </div>
                    `).join('');
                } else {
                    transactionsContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 1rem;">No recent transactions</p>';
                }

                // Top validators
                const validatorsContainer = document.getElementById('top-validators');
                if (data.topValidators && data.topValidators.length > 0) {
                    validatorsContainer.innerHTML = data.topValidators.slice(0, 5).map((validator, index) => `
                        <div style="padding: 0.75rem 0; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 500;">#${index + 1} ${validator.name}</div>
                                <div style="font-size: 0.75rem; color: var(--text-muted);">${parseInt(validator.stake).toLocaleString()} MON staked</div>
                            </div>
                            <span class="status success">
                                <div class="status-dot"></div>
                                ${validator.uptime}% uptime
                            </span>
                        </div>
                    `).join('');
                } else {
                    validatorsContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 1rem;">No validators data</p>';
                }

                // Top dApps
                const dappsContainer = document.getElementById('top-dapps');
                if (data.topDapps && data.topDapps.length > 0) {
                    dappsContainer.innerHTML = data.topDapps.slice(0, 5).map((dapp, index) => `
                        <div style="padding: 0.75rem 0; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 500;">#${index + 1} ${dapp.name}</div>
                                <div style="font-size: 0.75rem; color: var(--text-muted);">${dapp.category}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 500;">$${(dapp.tvl / 1000000).toFixed(1)}M</div>
                                <div style="font-size: 0.75rem; color: var(--text-muted);">TVL</div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    dappsContainer.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 1rem;">No dApps data</p>';
                }

            } catch (error) {
                console.error('Error loading dashboard data:', error);
                // Handle error by showing error messages in containers
                ['recent-transactions', 'top-validators', 'top-dapps'].forEach(id => {
                    const container = document.getElementById(id);
                    if (container) {
                        container.innerHTML = '<div class="error-message">Failed to load data</div>';
                    }
                });
            }
        });

        // Mobile menu toggle
        document.querySelector('.mobile-menu-toggle').addEventListener('click', () => {
            document.querySelector('.nav-links').classList.toggle('active');
        });

        // Auto refresh every 30 seconds
        setInterval(() => {
            window.location.reload();
        }, 30000);
    </script>
</body>
</html>